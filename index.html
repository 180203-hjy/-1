<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>+1教你学商务 - 2025期末复习终极版</title>
    <!-- 引入必要的库 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up {
            animation: fade-in-up 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ==========================================
        // 1. 图标组件 (SVG) - 纯函数组件，无状态
        // ==========================================
        const Icons = {
            Play: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>,
            RotateCcw: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"></path><path d="M3 3v9h9"></path></svg>,
            CheckCircle: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>,
            XCircle: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>,
            BookOpen: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>,
            Shuffle: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="16 3 21 3 21 8"></polyline><line x1="4" y1="20" x2="21" y2="3"></line><polyline points="21 16 21 21 16 21"></polyline><line x1="15" y1="15" x2="21" y2="21"></line><line x1="4" y1="4" x2="9" y2="9"></line></svg>,
            ChevronRight: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="9 18 15 12 9 6"></polyline></svg>,
            ChevronLeft: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="15 18 9 12 15 6"></polyline></svg>,
            Trophy: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M8 21h8"></path><path d="M12 17v4"></path><path d="M7 4h10"></path><path d="M17 4v7a5 5 0 0 1-10 0V4"></path><path d="M5 8v2a7 7 0 0 0 14 0V8"></path></svg>,
            List: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>,
            ArrowRight: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>,
            Lightbulb: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M9 18h6"></path><path d="M10 22h4"></path><path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 16.5 5c-1.79-2.25-5.33-2-7.36-.15a4.68 4.68 0 0 0-1.3 6c.65 1.54.9 2.78.9 4.15"></path></svg>,
            Eye: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>,
            EyeOff: ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>
        };

        // ==========================================
        // 2. 题库数据源 (已核对为完整原句)
        // ==========================================

        const principlesOptions = [
            "A. Courtesy (礼貌)",
            "B. Correctness (正确)", 
            "C. Conciseness (简洁)",
            "D. Clarity (清晰)", 
            "E. Concreteness (具体)", 
            "F. Completeness (完整)"
        ];

        const part1AQuestions = [
            {
                id: 'p1a-1',
                category: 'Part I-A: 6C Principles',
                question: "Definition: Treating people with respect and friendly human concern. Visualizing the reader before starting to write. (尊重他人，通过'你态度'关注读者)",
                options: principlesOptions,
                correctAnswer: "A. Courtesy (礼貌)",
                explanation: "【解析】Courtesy (礼貌) 的核心就是 'Treating people with respect' 和使用 'You-viewpoint' (你态度)。"
            },
            {
                id: 'p1a-2',
                category: 'Part I-A: 6C Principles',
                question: "Definition: Writing in the fewest possible words without sacrificing completeness and courtesy. (在不牺牲完整和礼貌的前提下用最少的词)",
                options: principlesOptions,
                correctAnswer: "C. Conciseness (简洁)",
                explanation: "【解析】Conciseness (简洁) 的关键词是 'fewest possible words' (最少的词)。"
            },
            {
                id: 'p1a-3',
                category: 'Part I-A: 6C Principles',
                question: "Definition: Using correct sentence structures, grammar, punctuation, and spelling. (使用正确的句式、语法、标点和拼写)",
                options: principlesOptions,
                correctAnswer: "B. Correctness (正确)",
                explanation: "【解析】Correctness (正确) 指的是语言规范，如语法(grammar)和标点(punctuation)无误。"
            },
            {
                id: 'p1a-4',
                category: 'Part I-A: 6C Principles',
                question: "Definition: Telling the reader exactly what the author wants and needs to know, using familiar words and simple sentences. (使用熟悉的词和简单句，清晰表达)",
                options: principlesOptions,
                correctAnswer: "D. Clarity (清晰)",
                explanation: "【解析】Clarity (清晰) 强调易读性，使用 'familiar words' (熟悉的词) 和 'simple sentences' (简单句)。"
            },
            {
                id: 'p1a-5',
                category: 'Part I-A: 6C Principles',
                question: "Definition: Being vivid, specific, and specific rather than vague, general, and abstract. (生动、具体，避免模糊和抽象)",
                options: principlesOptions,
                correctAnswer: "E. Concreteness (具体)",
                explanation: "【解析】Concreteness (具体) 的反义词是 vague (模糊)，强调使用具体的事实和数据。"
            },
            {
                id: 'p1a-6',
                category: 'Part I-A: 6C Principles',
                question: "Definition: Including all the necessary information and data in the message to help the sender get the receiver's response. (包含所有必要信息)",
                options: principlesOptions,
                correctAnswer: "F. Completeness (完整)",
                explanation: "【解析】Completeness (完整) 的核心是 'all necessary information' (所有必要信息)，缺一不可。"
            }
        ];

        // --- Part I-B: Sentence Comparison & Best Option ---
        const part1BQuestions = [
            // Courtesy & You-Viewpoint
            {
                id: 'p1b-1',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (You-viewpoint)",
                options: [
                    "A: We are happy to have your order for Kopper products, which we are sending today by Mercury Freight.",
                    "B: Your selection of Kopper products should reach you by Saturday, as they were shipped by Mercury Freight today."
                ],
                correctAnswer: "B: Your selection of Kopper products should reach you by Saturday, as they were shipped by Mercury Freight today.",
                explanation: "【解析】选 B。原则：You-viewpoint (你态度)。要关注读者什么时候能收到(Your selection... reach you)，而不是'我们'很高兴(We are happy)。"
            },
            {
                id: 'p1b-2',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (You-viewpoint)",
                options: [
                    "A: We sell the Forever cutlery set for the low price of $6 each and suggest a retail price of $8.5.",
                    "B: You can reap a $2.5 profit on each Forever set you sell at $8.5, for your cost is only $6."
                ],
                correctAnswer: "B: You can reap a $2.5 profit on each Forever set you sell at $8.5, for your cost is only $6.",
                explanation: "【解析】选 B。原则：You-viewpoint (你态度)。强调读者能赚到的利润(profit)，而不是卖家的售价。"
            },
            {
                id: 'p1b-3',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (You-viewpoint)",
                options: [
                    "A: We have shipped the three dozen desk sets you ordered.",
                    "B: Your three dozen desk sets should reach you with this letter."
                ],
                correctAnswer: "B: Your three dozen desk sets should reach you with this letter.",
                explanation: "【解析】选 B。原则：You-viewpoint (你态度)。主语是'你的产品'(Your desk sets)，关注送达时间。"
            },
            {
                id: 'p1b-4',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Positive Tone)",
                options: [
                    "A: You failed to give us the fabric specifications of the sofa you ordered.",
                    "B: In order that you may have the sofa you want, will you please check your choice of fabric on the enclosed card?"
                ],
                correctAnswer: "B: In order that you may have the sofa you want, will you please check your choice of fabric on the enclosed card?",
                explanation: "【解析】选 B。原则：Positive Tone (积极语气)。避免使用指责性词汇 'You failed' (你失败了/没做到)。"
            },
            {
                id: 'p1b-5',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Positive Tone)",
                options: [
                    "A: I cannot accept the recommendation of the site-selection committee.",
                    "B: I wish I could accept the recommendation of the site-selection committee."
                ],
                correctAnswer: "B: I wish I could accept the recommendation of the site-selection committee.",
                explanation: "【解析】选 B。原则：Positive Tone (积极语气)。'I wish I could' (我希望我能) 比直接说 'I cannot' (我不能) 更委婉、礼貌。"
            },
            {
                id: 'p1b-6',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Positive Tone)",
                options: [
                    "A: We regret to inform you that we must deny your request for credit.",
                    "B: For the time being, we can serve you only on a cash basis."
                ],
                correctAnswer: "B: For the time being, we can serve you only on a cash basis.",
                explanation: "【解析】选 B。原则：Positive Tone (积极语气)。A 强调'拒绝'(deny)，B 强调'目前能做什么'(cash basis)，更积极。"
            },
            // Clarity & Conversational
            {
                id: 'p1b-7',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conversational)",
                options: [
                    "A: Reference is made to your May 3 letter, in which you described the approved procedure for initiating a claim.",
                    "B: Please refer to your May 3 letter, in which you tell how to file a claim."
                ],
                correctAnswer: "B: Please refer to your May 3 letter, in which you tell how to file a claim.",
                explanation: "【解析】选 B。原则：Conversational (口语化)。A 中的 'Reference is made' 是陈旧的官僚腔，B 更自然。"
            },
            {
                id: 'p1b-8',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conversational)",
                options: [
                    "A: In reply to your June 18 letter, please be informed that your adherence to instructions outlined therein will greatly facilitate attainment of our objective.",
                    "B: By following the procedure you listed in your June 18 letter, you will help us reach our goal."
                ],
                correctAnswer: "B: By following the procedure you listed in your June 18 letter, you will help us reach our goal.",
                explanation: "【解析】选 B。原则：Conversational (口语化)。避免使用大词如 'facilitate attainment'，用简单的 'help us reach'。"
            },
            {
                id: 'p1b-9',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conversational)",
                options: [
                    "A: I shall be most pleased to avail myself of your kind suggestion when and if the price declines.",
                    "B: I shall gladly follow your suggestion if and when the price falls."
                ],
                correctAnswer: "B: I shall gladly follow your suggestion if and when the price falls.",
                explanation: "【解析】选 B。原则：Conversational (口语化)。'avail myself of' 过于正式和生硬，'follow your suggestion' 更通顺。"
            },
            {
                id: 'p1b-10',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Clarity)",
                options: [
                    "A: Company operations for the preceding accounting period terminated with a substantial deficit.",
                    "B: The company lost much money last year."
                ],
                correctAnswer: "B: The company lost much money last year.",
                explanation: "【解析】选 B。原则：Clarity (清晰)。'terminated with a substantial deficit' 是晦涩的行话，'lost money' 简单明了。"
            },
            {
                id: 'p1b-11',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Clarity)",
                options: [
                    "A: This machine has a tendency to develop excessive and unpleasant audible symptoms when operating at elevated temperature.",
                    "B: This machine tends to get noisy when it runs hot."
                ],
                correctAnswer: "B: This machine tends to get noisy when it runs hot.",
                explanation: "【解析】选 B。原则：Clarity (清晰)。'unpleasant audible symptoms' 就是 'noisy' (吵)，直接说就好。"
            },
            // Conciseness
            {
                id: 'p1b-12',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conciseness)",
                options: [
                    "A: Our new model is longer in length than the old one.",
                    "B: Our new model is longer than the old one."
                ],
                correctAnswer: "B: Our new model is longer than the old one.",
                explanation: "【解析】选 B。原则：Conciseness (简洁)。'Longer' 已经包含了长度的意思，'in length' 是多余的。"
            },
            {
                id: 'p1b-13',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conciseness)",
                options: [
                    "A: The consensus of opinion is that the tax is unfair.",
                    "B: The consensus is that the tax is unfair."
                ],
                correctAnswer: "B: The consensus is that the tax is unfair.",
                explanation: "【解析】选 B。原则：Conciseness (简洁)。'Consensus' 意为舆论/一致意见，已经包含了 'of opinion' 的意思。"
            },
            {
                id: 'p1b-14',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conciseness)",
                options: [
                    "A: There are five rules that should be observed.",
                    "B: Five rules should be observed."
                ],
                correctAnswer: "B: Five rules should be observed.",
                explanation: "【解析】选 B。原则：Conciseness (简洁)。去掉无意义的 'There are' 开头。"
            },
            {
                id: 'p1b-15',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conciseness)",
                options: [
                    "A: In the period between June and August they found the error.",
                    "B: Between June and August they found the error."
                ],
                correctAnswer: "B: Between June and August they found the error.",
                explanation: "【解析】选 B。原则：Conciseness (简洁)。'In the period' 是废话。"
            },
            {
                id: 'p1b-16',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conciseness)",
                options: [
                    "A: It came at a time when we were busy.",
                    "B: It came when we were busy."
                ],
                correctAnswer: "B: It came when we were busy.",
                explanation: "【解析】选 B。原则：Conciseness (简洁)。'at a time' 是多余的。"
            },
            {
                id: 'p1b-17',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conciseness)",
                options: [
                    "A: Leather depreciates in value slowly.",
                    "B: Leather depreciates slowly."
                ],
                correctAnswer: "B: Leather depreciates slowly.",
                explanation: "【解析】选 B。原则：Conciseness (简洁)。'depreciates' 意为贬值，已包含 'in value'。"
            },
            {
                id: 'p1b-18',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conciseness)",
                options: [
                    "A: It will cost a sum of $120.",
                    "B: It will cost $120."
                ],
                correctAnswer: "B: It will cost $120.",
                explanation: "【解析】选 B。原则：Conciseness (简洁)。'a sum of' 是多余的。"
            },
            {
                id: 'p1b-19',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conciseness)",
                options: [
                    "A: ...a certain person by the name of Bill Jones.",
                    "B: ...a person named Bill Jones."
                ],
                correctAnswer: "B: ...a person named Bill Jones.",
                explanation: "【解析】选 B。原则：Conciseness (简洁)。'by the name of' 太啰嗦，用 'named' 即可。"
            },
            {
                id: 'p1b-20',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conciseness)",
                options: [
                    "A: ...in the city of Columbus.",
                    "B: ...in Columbus."
                ],
                correctAnswer: "B: ...in Columbus.",
                explanation: "【解析】选 B。原则：Conciseness (简洁)。大家都知道 Columbus 是个城市，不用加 'the city of'。"
            },
            {
                id: 'p1b-21',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Conciseness)",
                options: [
                    "A: The radio sells for the price of $50.",
                    "B: The radio sells for $50."
                ],
                correctAnswer: "B: The radio sells for $50.",
                explanation: "【解析】选 B。原则：Conciseness (简洁)。'$' 符号本身就代表价格，'the price of' 重复了。"
            },
            // Concreteness
            {
                id: 'p1b-22',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Concreteness)",
                options: [
                    "A: We suffered a significant loss.",
                    "B: We suffered a 53% loss."
                ],
                correctAnswer: "B: We suffered a 53% loss.",
                explanation: "【解析】选 B。原则：Concreteness (具体)。用具体数字 '53%' 代替模糊的形容词 'significant'。"
            },
            {
                id: 'p1b-23',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Concreteness)",
                options: [
                    "A: We will finish it in the near future.",
                    "B: We will finish it by Thursday noon."
                ],
                correctAnswer: "B: We will finish it by Thursday noon.",
                explanation: "【解析】选 B。原则：Concreteness (具体)。'Thursday noon' 比 'near future' 更明确。"
            },
            {
                id: 'p1b-24',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Concreteness)",
                options: [
                    "A: The majority of students passed.",
                    "B: 70% of students passed."
                ],
                correctAnswer: "B: 70% of students passed.",
                explanation: "【解析】选 B。原则：Concreteness (具体)。用具体比例 '70%' 代替 'majority'。"
            },
            {
                id: 'p1b-25',
                category: 'Part I-B: Sentence Comparison',
                question: "Which sentence is more effective? (Concreteness)",
                options: [
                    "A: She is an excellent student.",
                    "B: She is among the top five in a class of 40."
                ],
                correctAnswer: "B: She is among the top five in a class of 40.",
                explanation: "【解析】选 B。原则：Concreteness (具体)。排名数据比 'excellent' 更有说服力。"
            },
            // === Complaint Response Best Option (Full Sentences) ===
            {
                id: 'p2-c1',
                category: 'Part I-B: Best Option (Formal Tone)',
                question: "Which option is best for opening?",
                options: ["A. I heard you were not happy with the service you received.", "B. It has been brought to my attention that you were dissatisfied with the service you received."],
                correctAnswer: "B. It has been brought to my attention that you were dissatisfied with the service you received.",
                explanation: "【解析】选 B。B 选项更正式(Formal)，使用了被动语态和 dissatisfied 等词。"
            },
            {
                id: 'p2-c2',
                category: 'Part I-B: Best Option (Formal Tone)',
                question: "Which option is best for customer value?",
                options: ["A. We value your custom.", "B. We're really pleased you shop with us."],
                correctAnswer: "A. We value your custom.",
                explanation: "【解析】选 A。Custom 指“惠顾/生意”，比 shop with us 更正式。"
            },
            {
                id: 'p2-c3',
                category: 'Part I-B: Best Option (Formal Tone)',
                question: "Which option is best for assurance?",
                options: ["A. I promise you that we take a lot of notice of our customers.", "B. I assure you that we take all customer feedback seriously."],
                correctAnswer: "B. I assure you that we take all customer feedback seriously.",
                explanation: "【解析】选 B。Assure (保证) 和 take seriously 是标准商务搭配。"
            },
            {
                id: 'p2-c4',
                category: 'Part I-B: Best Option (Formal Tone)',
                question: "Which option is best for apology?",
                options: ["A. I would like to apologise on behalf of the company for any inconvenience caused.", "B. My colleagues and I are really sorry you had such a nightmare."],
                correctAnswer: "A. I would like to apologise on behalf of the company for any inconvenience caused.",
                explanation: "【解析】选 A。On behalf of the company (代表公司) 是正式道歉模板。B 中的 nightmare 太情绪化。"
            },
            {
                id: 'p2-c5',
                category: 'Part I-B: Best Option (Formal Tone)',
                question: "Which option is best for taking action?",
                options: ["A. We have taken your suggestions on board and will review this process for the future.", "B. We like your ideas and we might use them in future to improve this process."],
                correctAnswer: "A. We have taken your suggestions on board and will review this process for the future.",
                explanation: "【解析】选 A。Take on board 意为采纳，比 like your ideas 更专业。"
            },
            {
                id: 'p2-c6',
                category: 'Part I-B: Best Option (Formal Tone)',
                question: "Which option is best for refund?",
                options: ["A. We are happy to refund you the difference in price.", "B. We accept that we will have to refund you the difference in price."],
                correctAnswer: "A. We are happy to refund you the difference in price.",
                explanation: "【解析】选 A。Happy to 体现了积极的服务态度，而 have to 显得勉强。"
            },
            {
                id: 'p2-c7',
                category: 'Part I-B: Best Option (Formal Tone)',
                question: "Which option is best for closing hope?",
                options: ["A. We hope this is all OK for you now.", "B. We trust that you will find this a satisfactory response."],
                correctAnswer: "B. We trust that you will find this a satisfactory response.",
                explanation: "【解析】选 B。Trust (相信) 和 Satisfactory response (满意的答复) 是正式用语。"
            },
            {
                id: 'p2-c8',
                category: 'Part I-B: Best Option (Formal Tone)',
                question: "Which option is best for final contact?",
                options: ["A. Should you wish to discuss this matter further, please let us know how best to contact you.", "B. Don't be shy! Call or email me if there's anything else you need."],
                correctAnswer: "A. Should you wish to discuss this matter further, please let us know how best to contact you.",
                explanation: "【解析】选 A。Should you wish 是正式倒装句，比 Don't be shy 得体得多。"
            },
            // === Chart Writing Best Option (Full Sentences) ===
            {
                id: 'p2-c26',
                category: 'Part I-B: Best Option (Chart Writing)',
                question: "Which sentence describes a trend?",
                options: ["A. Spending at DVD rental shops fell by 21 per cent over the twelve-month period.", "B. Spending at DVD rental shops was $0.4 billion."],
                correctAnswer: "A. Spending at DVD rental shops fell by 21 per cent over the twelve-month period.",
                explanation: "【解析】选 A。Trend (趋势) 需要动词表示变化 (fell by)，B 只是静态数据。"
            },
            {
                id: 'p2-c27',
                category: 'Part I-B: Best Option (Chart Writing)',
                question: "Which is the correct way to write this amount?",
                options: ["A. In 2017, US consumers spent 9.8 billion.", "B. In 2017, US consumers spent $9.8 billion."],
                correctAnswer: "B. In 2017, US consumers spent $9.8 billion.",
                explanation: "【解析】选 B。货币符号 $ 必须放在数字前面。"
            },
            {
                id: 'p2-c28',
                category: 'Part I-B: Best Option (Chart Writing)',
                question: "Which gives a more complete description?",
                options: ["A. Rent-by-post revenues went down by 20 per cent.", "B. Rent-by-post revenues went down by 20 per cent to $0.5 billion."],
                correctAnswer: "B. Rent-by-post revenues went down by 20 per cent to $0.5 billion.",
                explanation: "【解析】选 B。完整的描述应包含变化幅度 (down by) 和最终结果 (to)。"
            }
        ];

        // --- Part II: Single Choice ---
        const part2Questions = [
            // Adverts & Details
            {
                id: 'p2-1',
                category: 'Part II: Adverts',
                question: "Condition: The sofa is in _______ condition. (means very clean/perfect)",
                options: ["good", "immaculate", "nice", "clean"],
                correctAnswer: "immaculate",
                explanation: "【解析】选 immaculate。意为“完美的、无瑕疵的”，是二手广告中形容成色极好的高级词汇。"
            },
            {
                id: 'p2-2',
                category: 'Part II: Adverts',
                question: "Usage: There is no _______ on the furniture. (means no damage from use)",
                options: ["use and abuse", "cuts and bruises", "wear and tear", "damage and dirt"],
                correctAnswer: "wear and tear",
                explanation: "【解析】选 wear and tear。固定搭配，意为“磨损”。"
            },
            {
                id: 'p2-3',
                category: 'Part II: Adverts',
                question: "Reason for selling: Only selling due to _______ of space.",
                options: ["miss", "need", "lack", "want"],
                correctAnswer: "lack",
                explanation: "【解析】选 lack。Lack of space 意为“空间不足”。"
            },
            {
                id: 'p2-4',
                category: 'Part II: Adverts',
                question: "Object: Beautiful, large, white coffee table for _______.",
                options: ["sell", "sale", "sold", "selling"],
                correctAnswer: "sale",
                explanation: "【解析】选 sale。For sale 是固定搭配，意为“出售”。"
            },
            {
                id: 'p2-5',
                category: 'Part II: Adverts',
                question: "Action: I wanted to bring it to your _______.",
                options: ["mind", "eyes", "attention", "head"],
                correctAnswer: "attention",
                explanation: "【解析】选 attention。Bring it to your attention 意为“引起您的注意/告知您”。"
            },
            {
                id: 'p2-6',
                category: 'Part II: Adverts',
                question: "Medical Context: My grandmother could have taken a dangerous _______.",
                options: ["overeat", "overdose", "overdo", "overtake"],
                correctAnswer: "overdose",
                explanation: "【解析】选 overdose。Overdose 意为“药物过量”，符合语境。"
            },
            {
                id: 'p2-7',
                category: 'Part II: Adverts',
                question: "Work Context: There appeared to be only one pharmacist on _______.",
                options: ["work", "job", "duty", "line"],
                correctAnswer: "duty",
                explanation: "【解析】选 duty。On duty 意为“值班/在岗”。"
            },
            {
                id: 'p2-8',
                category: 'Part II: Adverts',
                question: "Solution: I hope you can _______ steps to make sure this does not happen again.",
                options: ["make", "do", "take", "get"],
                correctAnswer: "take",
                explanation: "【解析】选 take。Take steps 意为“采取措施”。"
            },
            {
                id: 'p2-41',
                category: 'Part II: Adverts Details',
                question: "Beautiful coffee table for _______ sale. (Needs to be sold now)",
                options: ["fast", "quick", "immediate", "now"],
                correctAnswer: "immediate",
                explanation: "【解析】选 immediate。Immediate sale 意为“急售”。"
            },
            {
                id: 'p2-42',
                category: 'Part II: Adverts Details',
                question: "Square _______, 120x120x50 cm.",
                options: ["size", "shape", "form", "style"],
                correctAnswer: "shape",
                explanation: "【解析】选 shape。Square (正方形) 描述的是形状。"
            },
            {
                id: 'p2-43',
                category: 'Part II: Adverts Details',
                question: "Asking price £50 or _______ offer.",
                options: ["near", "nearest", "close", "best"],
                correctAnswer: "nearest",
                explanation: "【解析】选 nearest。Or nearest offer (O.N.O) 是二手交易常用语，意为“或接近出价”。"
            },
            {
                id: 'p2-44',
                category: 'Part II: Adverts Details',
                question: "Perfect for books, magazines, or as a _______ feature.",
                options: ["design", "look", "style", "art"],
                correctAnswer: "design",
                explanation: "【解析】选 design。Design feature 意为“设计特色/装饰功能”。"
            },
            // Complaints
            {
                id: 'p2-9',
                category: 'Part II: Complaints',
                question: "Opening: It has been _______ to our attention that you were dissatisfied.",
                options: ["brought", "taken", "paid", "given"],
                correctAnswer: "brought",
                explanation: "【解析】选 brought。Bring to attention 是固定搭配。"
            },
            {
                id: 'p2-10',
                category: 'Part II: Complaints',
                question: "Customer Value: We _______ your custom.",
                options: ["like", "value", "love", "thank"],
                correctAnswer: "value",
                explanation: "【解析】选 value。Value your custom (重视您的惠顾) 是正式商务用语。"
            },
            {
                id: 'p2-11',
                category: 'Part II: Complaints',
                question: "Taking Action: We have taken your suggestions on _______.",
                options: ["hand", "board", "desk", "mind"],
                correctAnswer: "board",
                explanation: "【解析】选 board。Take on board 意为“采纳/听取”。"
            },
            {
                id: 'p2-12',
                category: 'Part II: Complaints',
                question: "Apology: I would like to apologise for the length of time it took to receive your final _______.",
                options: ["price", "quote", "bill", "check"],
                correctAnswer: "quote",
                explanation: "【解析】选 quote。Quote 指“报价/估价单”。"
            },
            {
                id: 'p2-13',
                category: 'Part II: Complaints',
                question: "Assurance: I have made a note to _______ that your next renewal runs smoothly.",
                options: ["sure", "insure", "ensure", "assure"],
                correctAnswer: "ensure",
                explanation: "【解析】选 ensure。Ensure 意为“确保”。"
            },
            {
                id: 'p2-14',
                category: 'Part II: Complaints',
                question: "Refund: We are happy to refund you the difference in price between the two _______.",
                options: ["rules", "policies", "polices", "politics"],
                correctAnswer: "policies",
                explanation: "【解析】选 policies。这里指 Insurance policies (保险单)。"
            },
            {
                id: 'p2-15',
                category: 'Part II: Complaints',
                question: "Closing: Should you _______ to discuss this matter further, please let us know.",
                options: ["want", "hope", "wish", "like"],
                correctAnswer: "wish",
                explanation: "【解析】选 wish。Should you wish = If you wish，正式文体常用。"
            },
            // CV
            {
                id: 'p2-16',
                category: 'Part II: CV',
                question: "Ability: I have a _______ ability to create successful marketing campaigns.",
                options: ["prove", "proven", "proof", "proving"],
                correctAnswer: "proven",
                explanation: "【解析】选 proven。Proven ability 意为“已证明的能力/经验”，简历必背。"
            },
            {
                id: 'p2-17',
                category: 'Part II: CV',
                question: "Teamwork: I am a strong _______.",
                options: ["collaborate", "collaborator", "collaboration", "collaborative"],
                correctAnswer: "collaborator",
                explanation: "【解析】选 collaborator。意为“协作者/善于合作的人”。"
            },
            {
                id: 'p2-18',
                category: 'Part II: CV',
                question: "Knowledge: I have _______ knowledge of marketing.",
                options: ["special", "specialist", "specialize", "specialty"],
                correctAnswer: "specialist",
                explanation: "【解析】选 specialist。Specialist knowledge 意为“专业知识”。"
            },
            {
                id: 'p2-19',
                category: 'Part II: CV',
                question: "Skill: I use my _______ in analytics.",
                options: ["expert", "expertise", "experience", "experiment"],
                correctAnswer: "expertise",
                explanation: "【解析】选 expertise。Expertise 指“专长/专门技能”。"
            },
            {
                id: 'p2-20',
                category: 'Part II: CV',
                question: "Role: I had _______ for the overall social media strategy.",
                options: ["responsible", "responsibility", "response", "responsibly"],
                correctAnswer: "responsibility",
                explanation: "【解析】选 responsibility。Have responsibility for 意为“负责...”。"
            },
            {
                id: 'p2-21',
                category: 'Part II: CV',
                question: "Quantity: I played a key role in _______ campaigns.",
                options: ["number", "numerous", "numberous", "numerical"],
                correctAnswer: "numerous",
                explanation: "【解析】选 numerous。Numerous 意为“大量的/许多”。"
            },
            {
                id: 'p2-22',
                category: 'Part II: CV',
                question: "Money: I started to _______ my blog through sponsored posts.",
                options: ["money", "monetise", "monetary", "cash"],
                correctAnswer: "monetise",
                explanation: "【解析】选 monetise。Monetise 意为“变现/赚钱”。"
            },
            {
                id: 'p2-23',
                category: 'Part II: CV',
                question: "Marketing: I worked to boost customer _______.",
                options: ["engage", "engagement", "engaging", "engaged"],
                correctAnswer: "engagement",
                explanation: "【解析】选 engagement。Customer engagement 意为“客户参与度/互动”。"
            },
            // Thank You
            {
                id: 'p2-24',
                category: 'Part II: Thank You',
                question: "Opening: I'm _______ writing to say thanks.",
                options: ["just", "only", "now", "simply"],
                correctAnswer: "just",
                explanation: "【解析】选 just。'I'm just writing...' 是非正式邮件常用的开场白。"
            },
            {
                id: 'p2-25',
                category: 'Part II: Thank You',
                question: "Helping: Thank you so much for stepping _______ to support us.",
                options: ["on", "in", "up", "out"],
                correctAnswer: "in",
                explanation: "【解析】选 in。Step in 意为“介入/施以援手”。"
            },
            {
                id: 'p2-26',
                category: 'Part II: Thank You',
                question: "Effort: I know you had to put _______ extra hours.",
                options: ["on", "in", "at", "up"],
                correctAnswer: "in",
                explanation: "【解析】选 in。Put in hours 意为“投入时间工作”。"
            },
            {
                id: 'p2-27',
                category: 'Part II: Thank You',
                question: "Workload: You had to catch _______ on your own work.",
                options: ["in", "up", "on", "with"],
                correctAnswer: "up",
                explanation: "【解析】选 up。Catch up on 意为“赶上/补上(工作)”。"
            },
            {
                id: 'p2-28',
                category: 'Part II: Thank You',
                question: "Closing: I'll be _______ touch again soon.",
                options: ["on", "at", "in", "with"],
                correctAnswer: "in",
                explanation: "【解析】选 in。In touch 意为“联系”。"
            },
            {
                id: 'p2-29',
                category: 'Part II: Thank You',
                question: "Future: I look forward _______ working with you.",
                options: ["for", "to", "on", "in"],
                correctAnswer: "to",
                explanation: "【解析】选 to。Look forward to doing sth. 是固定搭配。"
            },
            {
                id: 'p2-46',
                category: 'Part II: Thank You Details',
                question: "Your work on this was _______ helpful.",
                options: ["really", "very", "too", "much"],
                correctAnswer: "very",
                explanation: "【解析】选 very。这是标准搭配。"
            },
            {
                id: 'p2-47',
                category: 'Part II: Thank You Details',
                question: "Anyway, _______ again for everything.",
                options: ["thank", "thanks", "thanking", "thankful"],
                correctAnswer: "thanks",
                explanation: "【解析】选 thanks。Casual closing (随意的结尾) 用 Thanks again。"
            },
            // Charts
            {
                id: 'p2-30',
                category: 'Part II: Charts',
                question: "Contrast: Fewer people watch TV. _______, they use their tablets.",
                options: ["Instead", "However", "But", "While"],
                correctAnswer: "Instead",
                explanation: "【解析】选 Instead。Instead 意为“取而代之/作为替代”。"
            },
            {
                id: 'p2-31',
                category: 'Part II: Charts',
                question: "Similarity: Tablet users play games. _______, gaming is the top use for smartphones.",
                options: ["In contrast", "Similarly", "However", "Instead"],
                correctAnswer: "Similarly",
                explanation: "【解析】选 Similarly。两个句子的内容相似（都玩游戏），表示类比。"
            },
            {
                id: 'p2-32',
                category: 'Part II: Charts',
                question: "Contrast: Smartphones are for communication, _______ tablets are for entertainment.",
                options: ["similarly", "while", "as well", "also"],
                correctAnswer: "while",
                explanation: "【解析】选 while。While 在此表示两个同时发生的状态的对比。"
            },
            {
                id: 'p2-33',
                category: 'Part II: Charts',
                question: "Trend (Up): Sales _______ in 2010. (reached highest point)",
                options: ["top", "peaked", "up", "high"],
                correctAnswer: "peaked",
                explanation: "【解析】选 peaked。Peaked 意为“达到峰值”。"
            },
            {
                id: 'p2-34',
                category: 'Part II: Charts',
                question: "Trend (Pass): Smartphone sales _______ PC sales. (went past)",
                options: ["pass", "overtook", "over", "took over"],
                correctAnswer: "overtook",
                explanation: "【解析】选 overtook。Overtake 意为“超过/赶超”。"
            },
            {
                id: 'p2-35',
                category: 'Part II: Charts',
                question: "Trend (Down): PC sales _______ as smartphones grew. (got smaller)",
                options: ["shrink", "shrank", "small", "fell"],
                correctAnswer: "shrank",
                explanation: "【解析】选 shrank。Shrink (收缩/减少) 的过去式。"
            },
            {
                id: 'p2-36',
                category: 'Part II: Charts',
                question: "Trend (Fast): There was a _______ rise in sales.",
                options: ["sharp", "hard", "fastly", "sharpness"],
                correctAnswer: "sharp",
                explanation: "【解析】选 sharp。Sharp rise 意为“急剧上升”。"
            },
            {
                id: 'p2-37',
                category: 'Part II: Charts',
                question: "Trend (X2): Smartphone sales _______ in five years.",
                options: ["two", "doubled", "double", "dual"],
                correctAnswer: "doubled",
                explanation: "【解析】选 doubled。Double 在此作动词，意为“翻倍”。"
            },
            {
                id: 'p2-38',
                category: 'Part II: Charts',
                question: "Table Description: This table _______ the numbers of learners.",
                options: ["shows", "illustrates", "sees", "looks"],
                correctAnswer: "illustrates",
                explanation: "【解析】选 illustrates。Illustrate 是描述图表时比 show 更正式的词。"
            },
            {
                id: 'p2-39',
                category: 'Part II: Charts',
                question: "Emphasis: The prominence of English is _______. (very noticeable)",
                options: ["strike", "striking", "struck", "stroke"],
                correctAnswer: "striking",
                explanation: "【解析】选 striking。Striking 意为“显著的/引人注目的”。"
            },
            {
                id: 'p2-40',
                category: 'Part II: Charts',
                question: "Relationship: There is little _______ between native speakers and learners.",
                options: ["link", "correlation", "connection", "relation"],
                correctAnswer: "correlation",
                explanation: "【解析】选 correlation。Correlation 意为“相关性”。"
            },
            {
                id: 'p2-48',
                category: 'Part II: Chart Grammar',
                question: "There was a 14 per cent _______ in DVD sales. (Verb was 'dropped')",
                options: ["drop", "down", "low", "dropped"],
                correctAnswer: "drop",
                explanation: "【解析】选 drop。这里需要名词形式的 drop。"
            },
            {
                id: 'p2-49',
                category: 'Part II: Chart Grammar',
                question: "There was population _______ of 20 per cent. (Verb was 'grew')",
                options: ["grew", "growth", "grow", "growing"],
                correctAnswer: "growth",
                explanation: "【解析】选 growth。这里需要名词形式的 growth。"
            },
            {
                id: 'p2-50',
                category: 'Part II: Chart Grammar',
                question: "Sales increased _______ from 1984 to 2010. (In a gradual and regular way)",
                options: ["steady", "steadily", "slow", "slowly"],
                correctAnswer: "steadily",
                explanation: "【解析】选 steadily。副词修饰动词 increased，表示“平稳地”。"
            },
            {
                id: 'p2-51',
                category: 'Part II: Chart Grammar',
                question: "Smartphone sales continued to increase _______. (Suddenly and obviously)",
                options: ["drama", "dramatic", "dramatically", "drama-like"],
                correctAnswer: "dramatically",
                explanation: "【解析】选 dramatically。副词修饰动词，表示“戏剧性地/急剧地”。"
            },
            {
                id: 'p2-52',
                category: 'Part II: Chart Details',
                question: "English is spoken in roughly _______ as many countries as French.",
                options: ["two", "twice", "double", "second"],
                correctAnswer: "twice",
                explanation: "【解析】选 twice。Twice as many as 意为“是...的两倍”。"
            },
            {
                id: 'p2-53',
                category: 'Part II: Chart Details',
                question: "1.5 billion people are learning English _______ to 82 million studying French.",
                options: ["compare", "compared", "comparing", "comparison"],
                correctAnswer: "compared",
                explanation: "【解析】选 compared。Compared to 意为“与...相比”。"
            },
            {
                id: 'p2-54',
                category: 'Part II: Chart Details',
                question: "In _______ of native speakers, Chinese is the most spoken language.",
                options: ["view", "terms", "point", "case"],
                correctAnswer: "terms",
                explanation: "【解析】选 terms。In terms of (就...而言) 是图表描述必备短语。"
            },
            {
                id: 'p2-55',
                category: 'Part II: Chart Details',
                question: "_______ Japanese, it is the least studied language.",
                options: ["As", "As for", "About", "For"],
                correctAnswer: "As for",
                explanation: "【解析】选 As for。As for (至于...) 用于引出列表中的新话题。"
            },
            {
                id: 'p2-56',
                category: 'Part II: Chart Details',
                question: "Chinese has by _______ the greatest number of native speakers.",
                options: ["much", "far", "long", "way"],
                correctAnswer: "far",
                explanation: "【解析】选 far。By far (显然/极大地) 常用于修饰最高级。"
            },
            {
                id: 'p2-57',
                category: 'Part II: Chart Details',
                question: "Younger people like shopping on tablets, but they often use their smartphones _______ to buy things.",
                options: ["as well", "also", "too", "either"],
                correctAnswer: "as well",
                explanation: "【解析】选 as well。As well 放在句末，意为“也”。"
            }
        ];

        const allQuestions = [...part1AQuestions, ...part1BQuestions, ...part2Questions];

        // --- APP COMPONENT ---
        function BusinessEnglishApp() {
            const [currentScreen, setCurrentScreen] = useState('start');
            const [questionSet, setQuestionSet] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [score, setScore] = useState(0);
            const [answerStatus, setAnswerStatus] = useState(null);
            const [selectedOption, setSelectedOption] = useState(null);
            const [isShuffle, setIsShuffle] = useState(true);
            const [showHint, setShowHint] = useState(false);

            const shuffleArray = (array) => {
                const newArray = [...array];
                for (let i = newArray.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
                }
                return newArray;
            };

            const startQuiz = (mode) => {
                let q = [];
                if (mode === 'part1a') q = part1AQuestions;
                else if (mode === 'part1b') q = part1BQuestions;
                else if (mode === 'part1') q = [...part1AQuestions, ...part1BQuestions];
                else if (mode === 'part2') q = part2Questions;
                else q = allQuestions;

                if (isShuffle) {
                    q = shuffleArray(q);
                }

                setQuestionSet(q);
                setCurrentIndex(0);
                setScore(0);
                setAnswerStatus(null);
                setSelectedOption(null);
                setShowHint(false);
                setCurrentScreen('quiz');
            };

            const handleAnswer = (option) => {
                if (answerStatus) return;

                const currentQ = questionSet[currentIndex];
                setSelectedOption(option);

                const isCorrect = option === currentQ.correctAnswer;
                
                if (isCorrect) {
                    setAnswerStatus('correct');
                    setScore(prev => prev + 1);
                    setTimeout(() => {
                        nextQuestion();
                    }, 1500);
                } else {
                    setAnswerStatus('incorrect');
                }
            };

            const nextQuestion = () => {
                if (currentIndex + 1 < questionSet.length) {
                    setCurrentIndex(prev => prev + 1);
                    setAnswerStatus(null);
                    setSelectedOption(null);
                    setShowHint(false);
                } else {
                    setCurrentScreen('result');
                }
            };

            const prevQuestion = () => {
                if (currentIndex > 0) {
                    setCurrentIndex(prev => prev - 1);
                    setAnswerStatus(null);
                    setSelectedOption(null);
                    setShowHint(false);
                }
            };

            const parseQuestionText = (text) => {
                const match = text.match(/^(.*)\s*\(([^)]+)\)\s*$/);
                if (match && match.length === 3) {
                    return {
                        mainText: match[1].trim(),
                        hintText: match[2].trim(),
                        hasHint: true
                    };
                }
                return {
                    mainText: text,
                    hintText: null,
                    hasHint: false
                };
            };

            // 拆分为子组件函数
            const StartScreen = () => (
                <div className="min-h-screen bg-slate-50 flex items-center justify-center p-4 font-sans text-slate-800">
                    <div className="bg-white rounded-2xl shadow-xl p-6 md:p-8 max-w-md w-full border border-slate-100">
                        <div className="text-center mb-8">
                            <h1 className="text-3xl font-extrabold text-blue-700 mb-2">+1教你学商务</h1>
                            <p className="text-slate-500 font-medium">2025年最终版 · 90+ 原题</p>
                        </div>

                        <div className="space-y-3">
                            <div className="flex items-center justify-between bg-blue-50 p-3 rounded-lg cursor-pointer hover:bg-blue-100 transition-colors" onClick={() => setIsShuffle(!isShuffle)}>
                                <div className="flex items-center gap-2">
                                    <Icons.Shuffle className={`w-5 h-5 ${isShuffle ? 'text-blue-600' : 'text-slate-400'}`} />
                                    <span className="text-sm font-bold text-slate-700">题目乱序模式</span>
                                </div>
                                <div className={`w-10 h-6 rounded-full p-1 transition-colors ${isShuffle ? 'bg-blue-600' : 'bg-slate-300'}`}>
                                    <div className={`w-4 h-4 bg-white rounded-full transition-transform shadow-sm ${isShuffle ? 'translate-x-4' : ''}`}></div>
                                </div>
                            </div>

                            <div className="grid grid-cols-2 gap-3">
                                <button onClick={() => startQuiz('part1a')} className="flex flex-col items-center justify-center p-4 bg-white border-2 border-slate-100 hover:border-blue-500 hover:bg-blue-50 rounded-xl transition-all group">
                                    <Icons.List className="w-6 h-6 text-blue-500 mb-2 group-hover:scale-110 transition-transform" />
                                    <div className="text-sm font-bold">Part I-A</div>
                                    <div className="text-xs text-slate-400">6C原则匹配 (6题)</div>
                                </button>
                                <button onClick={() => startQuiz('part1b')} className="flex flex-col items-center justify-center p-4 bg-white border-2 border-slate-100 hover:border-blue-500 hover:bg-blue-50 rounded-xl transition-all group">
                                    <Icons.ArrowRight className="w-6 h-6 text-blue-500 mb-2 group-hover:scale-110 transition-transform" />
                                    <div className="text-sm font-bold">Part I-B</div>
                                    <div className="text-xs text-slate-400">句子辨析与最佳选项 (36题)</div>
                                </button>
                            </div>

                            <button onClick={() => startQuiz('part2')} className="w-full flex items-center justify-between p-4 bg-white border-2 border-slate-100 hover:border-blue-500 rounded-xl transition-all group">
                                <div className="flex items-center gap-3">
                                    <div className="bg-orange-100 p-2 rounded-lg text-orange-600">
                                        <Icons.Trophy className="w-5 h-5" />
                                    </div>
                                    <div className="text-left">
                                        <div className="font-bold text-slate-800">Part II: 单选填空</div>
                                        <div className="text-xs text-slate-500">投诉/简历/图表/广告 (49题)</div>
                                    </div>
                                </div>
                                <Icons.ChevronRight className="w-5 h-5 text-slate-300 group-hover:text-blue-500" />
                            </button>

                            <button onClick={() => startQuiz('all')} className="w-full p-4 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl font-bold shadow-lg shadow-blue-200 transition-all transform hover:scale-[1.02] flex items-center justify-center gap-2">
                                <Icons.Play className="w-5 h-5 fill-current" />
                                全卷模拟 (Part I + II)
                            </button>
                        </div>
                    </div>
                </div>
            );

            const ResultScreen = () => {
                const percentage = Math.round((score / questionSet.length) * 100);
                return (
                    <div className="min-h-screen bg-slate-50 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center border border-slate-100">
                            <div className="mb-6">
                                <div className={`w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-4 ${percentage >= 80 ? 'bg-yellow-100 text-yellow-600' : 'bg-blue-100 text-blue-600'}`}>
                                    {percentage >= 80 ? <Icons.Trophy className="w-12 h-12" /> : <Icons.BookOpen className="w-12 h-12" />}
                                </div>
                                <h2 className="text-2xl font-bold text-slate-800">练习结束</h2>
                                <p className="text-slate-500">来看下你的成绩吧</p>
                            </div>

                            <div className="grid grid-cols-2 gap-4 mb-8">
                                <div className="p-4 bg-green-50 rounded-xl border border-green-100">
                                    <div className="text-3xl font-bold text-green-600">{score}</div>
                                    <div className="text-xs text-green-800 font-bold uppercase tracking-wider">答对题数</div>
                                </div>
                                <div className="p-4 bg-blue-50 rounded-xl border border-blue-100">
                                    <div className="text-3xl font-bold text-blue-600">{percentage}%</div>
                                    <div className="text-xs text-blue-800 font-bold uppercase tracking-wider">正确率</div>
                                </div>
                            </div>

                            <button onClick={() => setCurrentScreen('start')} className="w-full flex items-center justify-center gap-2 p-4 bg-slate-800 hover:bg-slate-900 text-white rounded-xl font-bold transition-all shadow-lg">
                                <Icons.RotateCcw className="w-5 h-5" />
                                再练一次
                            </button>
                        </div>
                    </div>
                );
            };

            const QuizScreen = () => {
                const currentQ = questionSet[currentIndex];
                const { mainText, hintText, hasHint } = parseQuestionText(currentQ.question);
                
                return (
                    <div className="min-h-screen bg-slate-50 flex flex-col items-center p-4 font-sans">
                        <div className="w-full max-w-2xl">
                            {/* Header */}
                            <div className="flex items-center justify-between mb-6">
                                <div className="flex items-center gap-2 text-sm text-slate-500 font-medium">
                                    <span className="bg-white border border-slate-200 text-slate-700 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide">
                                        {currentQ.category}
                                    </span>
                                    <span>{currentIndex + 1} / {questionSet.length}</span>
                                </div>
                                <button onClick={() => setCurrentScreen('start')} className="text-slate-400 hover:text-slate-600 transition-colors">
                                    <Icons.XCircle className="w-6 h-6" />
                                </button>
                            </div>

                            {/* Progress Bar */}
                            <div className="w-full bg-slate-200 h-2.5 rounded-full mb-8 overflow-hidden">
                                <div 
                                    className="bg-blue-600 h-full rounded-full transition-all duration-500 ease-out"
                                    style={{ width: `${((currentIndex) / questionSet.length) * 100}%` }}
                                ></div>
                            </div>

                            {/* Question Card */}
                            <div className="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 md:p-8 mb-6 relative overflow-hidden">
                                <h3 className="text-lg md:text-xl font-bold text-slate-800 leading-relaxed mb-4">
                                    {mainText}
                                </h3>

                                {hasHint && (
                                    <div className="mb-6">
                                        {!showHint ? (
                                            <button 
                                                onClick={() => setShowHint(true)}
                                                className="flex items-center gap-2 text-sm font-bold text-amber-600 bg-amber-50 px-3 py-2 rounded-lg hover:bg-amber-100 transition-colors border border-amber-200"
                                            >
                                                <Icons.Lightbulb className="w-4 h-4" />
                                                显示提示
                                            </button>
                                        ) : (
                                            <div className="bg-amber-50 border-l-4 border-amber-400 p-3 rounded-r-lg animate-fade-in-up">
                                                <p className="text-sm font-medium text-amber-800 flex items-center justify-between">
                                                    <span className="flex items-center gap-2"><Icons.Lightbulb className="w-4 h-4" /> {hintText}</span>
                                                    <button onClick={() => setShowHint(false)} className="text-amber-600 hover:text-amber-800"><Icons.EyeOff className="w-4 h-4" /></button>
                                                </p>
                                            </div>
                                        )}
                                    </div>
                                )}

                                <div className="space-y-3">
                                    {currentQ.options.map((option, idx) => {
                                        let optionStyle = "border-slate-200 hover:border-blue-400 hover:bg-blue-50 text-slate-700";
                                        let icon = null;

                                        if (answerStatus) {
                                            if (option === currentQ.correctAnswer) {
                                                optionStyle = "border-green-500 bg-green-50 text-green-800 ring-1 ring-green-500 font-medium";
                                                icon = <Icons.CheckCircle className="w-5 h-5 text-green-600" />;
                                            } else if (option === selectedOption) {
                                                optionStyle = "border-red-500 bg-red-50 text-red-800 font-medium";
                                                icon = <Icons.XCircle className="w-5 h-5 text-red-600" />;
                                            } else {
                                                optionStyle = "border-slate-100 text-slate-400 opacity-60";
                                            }
                                        }

                                        return (
                                            <button
                                                key={idx}
                                                onClick={() => handleAnswer(option)}
                                                disabled={answerStatus !== null}
                                                className={`w-full p-4 rounded-xl border-2 text-left transition-all flex items-center justify-between group ${optionStyle}`}
                                            >
                                                <span className="text-sm md:text-base pr-4">{option}</span>
                                                {icon}
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>

                            {/* Explanation / Footer */}
                            <div className="min-h-[140px]">
                                {answerStatus && (
                                    <div className={`rounded-xl p-5 border animate-fade-in-up shadow-sm ${answerStatus === 'correct' ? 'bg-green-50 border-green-200 text-green-900' : 'bg-red-50 border-red-200 text-red-900'}`}>
                                        <div className="flex items-start gap-3">
                                            <div className="mt-0.5 shrink-0">
                                                {answerStatus === 'correct' ? <Icons.CheckCircle className="w-6 h-6 text-green-600" /> : <Icons.BookOpen className="w-6 h-6 text-red-600" />}
                                            </div>
                                            <div className="flex-1">
                                                <p className="font-bold text-base mb-2">
                                                    {answerStatus === 'correct' ? "回答正确！" : "回答错误"}
                                                </p>
                                                <p className="text-sm md:text-base leading-relaxed opacity-90">{currentQ.explanation}</p>
                                            </div>
                                        </div>
                                        
                                        <div className="mt-4 flex justify-end">
                                            {answerStatus === 'incorrect' ? (
                                                <button onClick={nextQuestion} className="bg-white border border-red-200 text-red-700 px-6 py-2 rounded-lg text-sm font-bold shadow-sm hover:shadow-md transition-all flex items-center gap-2">
                                                    下一题 <Icons.ArrowRight className="w-4 h-4" />
                                                </button>
                                            ) : (
                                                <div className="text-xs font-bold text-green-600 uppercase tracking-wider animate-pulse flex items-center gap-1">
                                                    自动跳转中...
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* Prev Button (Only show if not first question) */}
                            <div className="w-full flex justify-start mt-4">
                                <button 
                                    onClick={prevQuestion} 
                                    disabled={currentIndex === 0}
                                    className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${currentIndex === 0 ? 'text-slate-300 cursor-not-allowed' : 'text-slate-500 hover:text-blue-600 hover:bg-blue-50'}`}
                                >
                                    <Icons.ChevronLeft className="w-4 h-4" />
                                    上一题
                                </button>
                            </div>

                        </div>
                    </div>
                );
            };

            // Main Render
            if (currentScreen === 'start') {
                return <StartScreen />;
            }

            if (currentScreen === 'result') {
                return <ResultScreen />;
            }

            return <QuizScreen />;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<BusinessEnglishApp />);
    </script>
</body>
</html>